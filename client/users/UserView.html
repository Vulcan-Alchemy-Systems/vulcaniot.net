<template name="UserView">
  {{> ContentHeader title=getUser.profile.name subTitle="View"}}
    <section class="content">
      <div id="alert"></div>
    {{#if isInRole 'manager'}}
    <div class="row">
      <div class="col-xs-12">
        <div class="nav-tabs-custom">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#activity" data-toggle="tab">Profile</a></li>
            <li><a href="#roles" data-toggle="tab">Roles</a></li>
            <li><a href="#history" data-toggle="tab">History</a></li>
            {{#if isUserInRole getUser._id 'employee'}}
            <li><a href="#timeclock" data-toggle="tab">Time Clock</a></li>
            {{/if}}
          </ul>
          <div class="tab-content">
            <div class="active tab-pane" id="activity">
              {{#if $.Session.get 'EditUser'}}
                {{> UserEdit}}
              {{else }}
              <h3>Contact Info</h3>
              <!-- Basic Stuff -->
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <p><b>Name:</b> {{getUser.profile.name}}</p>
                </div>
                <div class="col-xs-12 col-sm-3">
                  <p><b>Created:</b> {{dateFormat getUser.profile.createdAt}}</p>
                </div>
                <div class="col-xs-12 col-sm-3">
                  <p><b>Status:</b> {{getUser.profile.status}}</p>
                </div>
              </div>

              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <p><b>E-Mail:</b> {{getUserEmail}}</p>
                </div>
                <div class="col-xs-12 col-sm-3">
                  <p><b>Website:</b> {{#if getUser.profile.website}}{{getUser.profile.website}}{{else}}N/A{{/if}}</p>
                </div>
                <div class="col-xs-12 col-sm-3">
                  <p><b>Birthdate:</b> {{#if getUser.profile.birthday}}{{dateShortFormat getUser.profile.birthday}}{{else}}N/A{{/if}}</p>
                </div>
              </div>

              <div class="row">
                <div class="col-xs-12 col-sm-9">
                  <p><b>Position:</b> {{#if getUser.profile.position}}{{getUser.profile.position}}{{else}}N/A{{/if}}</p>
                </div>
                <div class="col-xs-12 col-sm-3">
                  <p><b>Gender:</b> {{#if getUser.profile.gender}}{{getUser.profile.gender}}{{else}}N/A{{/if}}</p>
                </div>
              </div>


              <!-- Phones -->
              <div class="row">
                {{#each getUser.profile.phones}}
                <div class="col-xs-12 col-sm-4">
                  <p><b>{{type}}:</b> {{number}}</p>
                </div>
                {{else}}
                <div class="col-xs-12">
                  <div class="alert alert-info">
                    <p><i class="fa fa-info-circle"></i> No Phone Numbers</p>
                  </div>
                </div>
                {{/each}}
              </div>

              <!-- Address -->
              <div class="row">
                {{#each getUser.profile.address}}
                <div class="col-xs-12 col-sm-6">
                  <h4>{{type}}</h4>
                  <div class="row">
                    <div class="col-xs-12">
                      <p>{{street}}</p>
                    </div>
                  </div>
                  {{#if streetCont}}
                  <div class="row">
                    <div class="col-xs-12">
                      <p><b>Street Cont: </b></p>
                    </div>
                  </div>
                  {{/if}}
                  <div class="row">
                    <div class="col-xs-12">
                      {{city}}, {{state}} {{postal}}
                    </div>
                  </div>
                </div>
                {{else}}
                <div class="col-xs-12">
                  <div class="alert alert-info">
                    <p><i class="fa fa-info-circle"></i> No Addresses</p>
                  </div>
                </div>
                {{/each}}
              </div>

              <div class="row">
                <div class="col-xs-12">
                  <span class="pull-right">
                  {{#if isInRole 'admin'}}
                    <a href="/admin/users/{{getUser._id}}/delete" title="Delete user" class="btn btn-danger delete-user"><i class="fa fa-trash"></i> Delete</a>
                  {{/if}}
                    <a href="#" title="Edit user" class="btn btn-warning edit-user"><i class="fa fa-pencil"></i> Edit</a>
                  </span>
                </div>
              </div>
            {{/if}}
            </div>

            <!-- Roles -->
            <div class="tab-pane" id="roles">
              <!-- Roles -->
              <div class="row">
                  <div class="col-xs-12 col-sm-4">
                    <input type="hidden" name="userId" id="userId" value="{{getUser._id}}" />
                    <div class="input-group">
                      <select id="role" name="role" class="form-control">
                      {{#each listRoles}}
                        <option value="{{name}}">{{name}}</option>
                      {{/each}}
                      </select>
                      <span class="input-group-btn">
                        <button class="btn btn-primary add-role-to-users" type="button">Add Role</button>
                      </span>
                    </div><!-- /input-group -->
                  </div>
                </div>

                <br />
              {{#each listUserRoles}}
              <span class="label label-primary">{{listUserRoles}} <a href="#" title="Remove Role" class="remove-role"><i class="fa fa-times"></i></a></span>
              {{else}}
              <div class="row">
                <div class="col-xs-12">
                  <div class="alert alert-info">
                    <p><i class="fa fa-info-circle"></i> No Roles!</p>
                  </div>
                </div>
              </div>
              {{/each}}
            </div>

            <!-- History -->
            <div class="tab-pane" id="history">
              {{> UserHistory}}
            </div>

            <!-- timeclock -->
            <div class="tab-pane" id="timeclock">
              {{> UserAdminTime}}
            </div>

          </div>
        </div>
      </div>
    </div>
    {{else}}
    <h1>Not Authorized</h1>
    {{/if}}
    </section>
</template>
